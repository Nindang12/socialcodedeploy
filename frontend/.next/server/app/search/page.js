(()=>{var e={};e.id=959,e.ids=[959],e.modules={151:(e,t,r)=>{var s=r(5718);e.exports=function(){return s.Date.now()}},222:(e,t,r)=>{var s=r(9474),o=Object.prototype,i=o.hasOwnProperty,n=o.toString,a=s?s.toStringTag:void 0;e.exports=function(e){var t=i.call(e,a),r=e[a];try{e[a]=void 0;var s=!0}catch(e){}var o=n.call(e);return s&&(t?e[a]=r:delete e[a]),o}},440:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var s=r(1658);let o=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,s.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},540:(e,t,r)=>{var s=r(5048),o=r(151),i=r(1539),n=Math.max,a=Math.min;e.exports=function(e,t,r){var l,c,d,u,p,m,h=0,x=!1,f=!1,v=!0;if("function"!=typeof e)throw TypeError("Expected a function");function g(t){var r=l,s=c;return l=c=void 0,h=t,u=e.apply(s,r)}function b(e){var r=e-m,s=e-h;return void 0===m||r>=t||r<0||f&&s>=d}function j(){var e,r,s,i=o();if(b(i))return y(i);p=setTimeout(j,(e=i-m,r=i-h,s=t-e,f?a(s,d-r):s))}function y(e){return(p=void 0,v&&l)?g(e):(l=c=void 0,u)}function k(){var e,r=o(),s=b(r);if(l=arguments,c=this,m=r,s){if(void 0===p)return h=e=m,p=setTimeout(j,t),x?g(e):u;if(f)return clearTimeout(p),p=setTimeout(j,t),g(m)}return void 0===p&&(p=setTimeout(j,t)),u}return t=i(t)||0,s(r)&&(x=!!r.leading,d=(f="maxWait"in r)?n(i(r.maxWait)||0,t):d,v="trailing"in r?!!r.trailing:v),k.cancel=function(){void 0!==p&&clearTimeout(p),h=0,l=m=c=p=void 0},k.flush=function(){return void 0===p?u:y(o())},k}},663:e=>{e.exports="object"==typeof global&&global&&global.Object===Object&&global},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},864:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,6444,23)),Promise.resolve().then(r.t.bind(r,6042,23)),Promise.resolve().then(r.t.bind(r,8170,23)),Promise.resolve().then(r.t.bind(r,9477,23)),Promise.resolve().then(r.t.bind(r,9345,23)),Promise.resolve().then(r.t.bind(r,2089,23)),Promise.resolve().then(r.t.bind(r,6577,23)),Promise.resolve().then(r.t.bind(r,1307,23))},1539:(e,t,r)=>{var s=r(7643),o=r(5048),i=r(9227),n=0/0,a=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,c=/^0o[0-7]+$/i,d=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(i(e))return n;if(o(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=o(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=s(e);var r=l.test(e);return r||c.test(e)?d(e.slice(2),r?2:8):a.test(e)?n:+e}},1630:e=>{"use strict";e.exports=require("http")},2412:e=>{"use strict";e.exports=require("assert")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3178:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>c});var s=r(5239),o=r(8088),i=r(8170),n=r.n(i),a=r(893),l={};for(let e in a)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>a[e]);r.d(t,l);let c={children:["",{children:["search",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,4332)),"/home/nin/Documents/SocialNetworkdeploy/frontend/src/app/search/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,4431)),"/home/nin/Documents/SocialNetworkdeploy/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,5284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,d=["/home/nin/Documents/SocialNetworkdeploy/frontend/src/app/search/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:o.RouteKind.APP_PAGE,page:"/search/page",pathname:"/search",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3773:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var s=r(687),o=r(3210),i=r(6189),n=r(1060),a=r(7760),l=r(3872),c=r(8133),d=r(540),u=r.n(d),p=r(5814),m=r.n(p);function h(){let e=(0,i.useRouter)(),[t,r]=(0,o.useState)(""),[d,p]=(0,o.useState)("posts"),[h,x]=(0,o.useState)([]),[f,v]=(0,o.useState)(!1),[g,b]=(0,o.useState)(""),[j,y]=(0,o.useState)({}),[k,w]=(0,o.useState)({}),[N,_]=(0,o.useState)([]),[S,P]=(0,o.useState)([]),[C,$]=(0,o.useState)([]),[q,T]=(0,o.useState)([]),[A,z]=(0,o.useState)(null),O=(0,o.useCallback)(u()(e=>{if(!e.trim()){x([]);return}v(!0),b("");let t=localStorage.getItem("token"),r="";r="posts"===d?`http://127.0.0.1:8000/search/posts?query=${encodeURIComponent(e)}`:`http://127.0.0.1:8000/search/users?query=${encodeURIComponent(e)}`,n.A.get(r,{headers:{Authorization:`Bearer ${t}`}}).then(e=>{if("posts"===d){let t=e.data.results||[];x(t);let r={};t.forEach(e=>{let t=e.liked_by?.map(e=>String(e).trim()).includes(String(A?.user_id).trim()),s=e.reposted_by?.map(e=>String(e).trim()).includes(String(A?.user_id).trim());r[e.post_id]={liked:t,likeCount:e.likes||0,reposted:s,repostCount:e.reposts||0}}),w(e=>({...e,...r}))}else x(e.data.users||[])}).catch(e=>{b("Kh\xf4ng t\xecm thấy kết quả hoặc c\xf3 lỗi xảy ra."),x([])}).finally(()=>{v(!1)})},500),[d,A]),I=e=>{p(e),x([]),b(""),t.trim()&&O(t)},D=async e=>{try{let t=localStorage.getItem("token"),r=await fetch(`http://127.0.0.1:8000/posts/${e.post_id}/like`,{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(r.ok){let t=await r.json(),s=t.liked_by?.map(e=>String(e).trim()).includes(String(A?.user_id).trim());w(r=>({...r,[e.post_id]:{...r[e.post_id],liked:s,likeCount:t.likes??r[e.post_id]?.likeCount??e.likes??0}}))}}catch(e){console.error("Error liking post:",e)}},E=async e=>{try{let t=localStorage.getItem("token"),r=await fetch(`http://127.0.0.1:8000/posts/${e.post_id}/repost`,{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(r.ok){let t=await r.json(),s=t.reposted_by?.map(e=>String(e).trim()).includes(String(A?.user_id).trim());w(r=>({...r,[e.post_id]:{...r[e.post_id],reposted:s,repostCount:t.reposts??r[e.post_id]?.repostCount??e.reposts??0}}))}}catch(e){console.error("Error reposting post:",e)}};return(0,s.jsxs)("div",{className:"w-full h-screen bg-gray-100 flex flex-col items-center p-4",children:[(0,s.jsx)("h1",{className:"text-xl font-bold mb-4",children:"T\xecm kiếm"}),(0,s.jsx)("div",{className:"max-w-xl w-full h-auto",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-md p-4 space-y-4",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:"text",placeholder:"T\xecm kiếm...",className:"w-full p-2 pl-10 border rounded-lg focus:outline-none",value:t,onChange:e=>{r(e.target.value),O(e.target.value)}}),(0,s.jsx)("svg",{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),(0,s.jsxs)("div",{className:"flex border-b",children:[(0,s.jsx)("button",{className:`px-4 py-2 ${"posts"===d?"border-b-2 border-blue-500 text-blue-500":"text-gray-500"}`,onClick:()=>I("posts"),children:"B\xe0i viết"}),(0,s.jsx)("button",{className:`px-4 py-2 ${"users"===d?"border-b-2 border-blue-500 text-blue-500":"text-gray-500"}`,onClick:()=>I("users"),children:"Người d\xf9ng"})]}),(0,s.jsxs)("div",{className:"space-y-4 min-h-[100px] overflow-y-auto max-h-[560px]",children:[f&&(0,s.jsx)("div",{className:"text-gray-400",children:"Đang t\xecm kiếm..."}),g&&(0,s.jsx)("div",{className:"text-red-500 text-sm",children:g}),!f&&!g&&0===h.length&&(0,s.jsx)("div",{className:"text-gray-400 text-sm",children:"Kh\xf4ng c\xf3 kết quả."}),"posts"===d&&h.map(t=>{let r=j[t.user_id]||{},o=k[t.post_id]||{liked:t.liked_by?.map(e=>String(e).trim()).includes(String(A?.user_id).trim()),likeCount:t.likes||0,reposted:t.reposted_by?.map(e=>String(e).trim()).includes(String(A?.user_id).trim()),repostCount:t.reposts||0};return(0,s.jsxs)("div",{className:"bg-white text-black p-4 shadow-md w-full rounded-lg border hover:bg-gray-50 cursor-pointer mb-2 flex gap-3",onClick:()=>e.push(`/comment/${t.post_id}`),children:[(0,s.jsx)("img",{src:r.avatar?`http://127.0.0.1:8000/media/${r.avatar}`:"https://placehold.co/40x40",alt:"Avatar",className:"w-10 h-10 rounded-full"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"font-semibold",children:r.username||"user"}),(0,s.jsx)("span",{className:"text-xs text-gray-500",children:t.created_at?function(e){let t=new Date,r=new Date(e),s=Math.floor((t.getTime()-r.getTime())/6e4);if(s<1)return"vừa xong";if(s<60)return`${s} ph\xfat`;if(s<1440){let e=Math.floor(s/60);return`${e} giờ`}{let e=Math.floor(s/1440);return`${e} ng\xe0y`}}(t.created_at):"time"})]}),(0,s.jsx)("div",{className:"mt-1 break-words",children:t.content}),t.image_id&&(0,s.jsx)("img",{src:`http://127.0.0.1:8000/media/${t.image_id}`,alt:"Post",className:"mt-2 rounded-lg max-w-full"}),t.video_id&&(0,s.jsx)("video",{src:`http://127.0.0.1:8000/media/${t.video_id}`,controls:!0,className:"mt-2 rounded-lg w-full"}),(0,s.jsxs)("div",{className:"flex gap-4 text-gray-500 mt-3",children:[(0,s.jsxs)("button",{className:"flex items-center space-x-1 hover:text-black",onClick:e=>{e.stopPropagation(),D(t)},children:[(0,s.jsx)(a.A,{className:o.liked?"text-red-500":"text-gray-500",size:18}),(0,s.jsx)("span",{children:o.likeCount??t.likes??0})]}),(0,s.jsxs)("button",{className:"flex items-center space-x-1 hover:text-black",onClick:r=>{r.stopPropagation(),e.push(`/comment/${t.post_id}`)},children:[(0,s.jsx)(l.A,{size:18}),(0,s.jsx)("span",{children:t.comments??0})]}),(0,s.jsxs)("button",{className:"flex items-center space-x-1 hover:text-black",onClick:e=>{e.stopPropagation(),E(t)},children:[(0,s.jsx)(c.A,{className:o.reposted?"text-green-500":"text-gray-500",size:18}),(0,s.jsx)("span",{children:o.repostCount??t.reposts??0})]})]})]})]},t.post_id)}),"users"===d&&h.map(e=>(0,s.jsxs)(m(),{href:`/profile/${e.user_id}`,className:"block p-2 border rounded mb-2 hover:bg-gray-100 transition",children:[(0,s.jsx)("div",{className:"font-semibold",children:e.username}),(0,s.jsxs)("div",{className:"text-xs text-gray-500",children:["ID: ",e.user_id]})]},e.user_id))]})]})})]})}},3873:e=>{"use strict";e.exports=require("path")},4075:e=>{"use strict";e.exports=require("zlib")},4263:()=>{},4332:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/nin/Documents/SocialNetworkdeploy/frontend/src/app/search/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/nin/Documents/SocialNetworkdeploy/frontend/src/app/search/page.tsx","default")},4339:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var s=r(687),o=r(6482),i=r.n(o),n=r(4716),a=r.n(n);r(4263);var l=r(3210),c=r(5814),d=r.n(c);function u(){let[e,t]=(0,l.useState)(!1),[r,o]=(0,l.useState)(!1),[i,n]=(0,l.useState)(!1);return(0,s.jsxs)("div",{className:"flex justify-center items-center relative",children:[(0,s.jsx)("button",{className:"hover:bg-slate-200 p-3 rounded-lg",onClick:()=>t(e=>!e),children:(0,s.jsx)("img",{width:20,src:"/assets/option-row.svg",alt:"option"})}),e&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50",onClick:()=>t(!1),children:(0,s.jsx)("div",{className:`absolute bg-white rounded-2xl shadow-lg p-4 ${i?"bottom-0 left-0 right-0 rounded-t-2xl":"bottom-24 left-5 w-48"}`,onClick:e=>e.stopPropagation(),children:(0,s.jsx)("div",{className:"border-t",children:(0,s.jsx)("button",{className:"py-3 text-black w-full hover:bg-slate-200 rounded-lg",onClick:()=>{o(!1),console.log("Logging out..."),document.cookie="token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",localStorage.removeItem("token"),localStorage.removeItem("lastLoginTime"),localStorage.removeItem("currentUser"),window.location.href="/login"},children:"Đăng xuất"})})})})]})}function p(){let[e,t]=(0,l.useState)(null),[r,o]=(0,l.useState)(null);return(0,s.jsx)("div",{children:(0,s.jsxs)("div",{className:"flex flex-col justify-between py-5 md:w-20 md:h-screen items-center bg-zinc-50 w-screen h-20",children:[(0,s.jsx)("img",{width:40,className:"hidden md:block",src:"/loom.png",alt:"logo"}),(0,s.jsxs)("div",{className:"flex md:flex-col md:gap-16 gap-5 flex-row",children:[(0,s.jsx)(d(),{href:"/",className:"hover:bg-slate-200 p-3 rounded-lg",children:(0,s.jsx)("img",{width:22,src:"/assets/home.svg",alt:"home"})}),(0,s.jsx)(d(),{href:"/search",className:"hover:bg-slate-200 p-3 rounded-lg",children:(0,s.jsx)("img",{width:22,src:"/assets/search.svg",alt:"search"})}),(0,s.jsx)(d(),{href:"/likepage",className:"hover:bg-slate-200 p-3 rounded-lg relative cursor-pointer",children:(0,s.jsx)("img",{width:22,src:"/assets/heart.svg",alt:"heart"})}),e?.user_id&&(0,s.jsx)(d(),{href:`/profile/${e.user_id}`,className:"hover:bg-slate-200 p-3 rounded-lg",children:(0,s.jsx)("img",{width:20,src:"/assets/profile.svg",alt:"profile"})})]}),(0,s.jsx)("div",{className:"pb-10",children:(0,s.jsx)(u,{})})]})})}var m=r(6189);function h({children:e}){(0,m.useRouter)();let t=(0,m.usePathname)();return(0,s.jsx)("html",{lang:"en",children:(0,s.jsx)("body",{className:`${i().variable} ${a().variable} antialiased`,children:(0,s.jsxs)("div",{className:"flex",children:["/login"!==t&&"/signup"!==t&&(0,s.jsx)(p,{}),e]})})})}},4416:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,6346,23)),Promise.resolve().then(r.t.bind(r,7924,23)),Promise.resolve().then(r.t.bind(r,5656,23)),Promise.resolve().then(r.t.bind(r,99,23)),Promise.resolve().then(r.t.bind(r,8243,23)),Promise.resolve().then(r.t.bind(r,8827,23)),Promise.resolve().then(r.t.bind(r,2763,23)),Promise.resolve().then(r.t.bind(r,7173,23))},4431:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/nin/Documents/SocialNetworkdeploy/frontend/src/app/layout.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/nin/Documents/SocialNetworkdeploy/frontend/src/app/layout.tsx","default")},4647:()=>{},4713:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},4735:e=>{"use strict";e.exports=require("events")},5048:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},5511:e=>{"use strict";e.exports=require("crypto")},5591:e=>{"use strict";e.exports=require("https")},5630:(e,t,r)=>{Promise.resolve().then(r.bind(r,4332))},5718:(e,t,r)=>{var s=r(663),o="object"==typeof self&&self&&self.Object===Object&&self;e.exports=s||o||Function("return this")()},6053:e=>{var t=/\s/;e.exports=function(e){for(var r=e.length;r--&&t.test(e.charAt(r)););return r}},7467:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},7643:(e,t,r)=>{var s=r(6053),o=/^\s+/;e.exports=function(e){return e?e.slice(0,s(e)+1).replace(o,""):e}},7910:e=>{"use strict";e.exports=require("stream")},8354:e=>{"use strict";e.exports=require("util")},8678:(e,t,r)=>{Promise.resolve().then(r.bind(r,3773))},9021:e=>{"use strict";e.exports=require("fs")},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9227:(e,t,r)=>{var s=r(9395),o=r(7467);e.exports=function(e){return"symbol"==typeof e||o(e)&&"[object Symbol]"==s(e)}},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9395:(e,t,r)=>{var s=r(9474),o=r(222),i=r(4713),n=s?s.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":n&&n in Object(e)?o(e):i(e)}},9474:(e,t,r)=>{e.exports=r(5718).Symbol},9551:e=>{"use strict";e.exports=require("url")},9624:(e,t,r)=>{Promise.resolve().then(r.bind(r,4339))},9896:(e,t,r)=>{Promise.resolve().then(r.bind(r,4431))}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[447,240,658,832],()=>r(3178));module.exports=s})();